<!doctype html><html><head><meta charset="utf-8"><title>Editor - GOD MADARA</title></head><body><h2>{{ header }}</h2><h3>Project: {{ proj }}</h3><select id="files" onchange="loadFile()"></select><button onclick="createFile()">New File</button><button onclick="deleteFile()">Delete</button><button onclick="saveFile()">Save</button><div id="editor" style="height:60vh;border:1px solid #ccc"></div><script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.9.6/ace.js"></script><script>var editor=ace.edit("editor");editor.setTheme("ace/theme/monokai");async function listFiles(){let r=await fetch("/editor/api/files/{{ uid }}/{{ proj }}");let js=await r.json();let sel=document.getElementById("files");sel.innerHTML="";js.files.forEach(f=>{let o=document.createElement("option");o.value=f;o.text=f;sel.appendChild(o)});if(js.files.length) loadFile();}async function loadFile(){let f=document.getElementById("files").value;let r=await fetch("/editor/api/file/{{ uid }}/{{ proj }}?path="+encodeURIComponent(f));let txt=await r.text();editor.setValue(txt,-1);}async function saveFile(){let f=document.getElementById("files").value;let content=editor.getValue();await fetch("/editor/api/file/{{ uid }}/{{ proj }}",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:f,content:content})});alert("Saved and restart requested.");}async function createFile(){let name=prompt("Filename");if(!name) return;await fetch("/editor/api/file/{{ uid }}/{{ proj }}",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:name,content:""})});await listFiles();}async function deleteFile(){let f=document.getElementById("files").value;if(!confirm("Delete "+f+"?")) return;await fetch("/editor/api/file/{{ uid }}/{{ proj }}",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:f})});await listFiles();}listFiles();</script></body></html>